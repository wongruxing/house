import{A as m,s as j,u as h,N as L,C as _,T as f,S as p,g as ae}from"./date-range-fd9b2d93.js";import{L as x}from"./line-67ef0491.js";import{d as ne,r as s,w as se,h as k,o as le,c as d,a as e,b as n,u as c,t as r,k as oe,F as M,j as P,i as ie,g as R,f as u,n as q,_ as re}from"./index-0ef19f66.js";const ce="/frontend/assets/jy-6ac73372.jpg",de="/frontend/assets/cf-d4734c19.jpg",ue={class:"statis-box"},ve={class:"statis-item"},me={class:"flex-between icon-box"},he={class:"flex-between"},_e={class:"num-box"},ge={class:"flex-between num-item"},ye={class:"num-value"},be={class:"flex-between num-item"},fe={class:"num-value"},pe={class:"flex-between num-item"},xe={class:"num-value"},ke={class:"area-box"},Ce={class:"line-only"},we={class:"line-inner-box"},Ae={class:"flex-between margin-top-30"},Be={class:"flex-between"},Ie={class:"chart-1"},Se={class:"chart-content-1"},Te={class:"chart-content-value"},Ne={class:"chart-1"},De={class:"chart-content-1"},Fe={class:"chart-content-value"},Oe={class:"chart-line-box"},je={class:"chart-filter"},Le={class:"chart-filter-item-box"},Me=["onClick"],Pe={class:"statis-item"},Re={class:"content-box"},qe={class:"margin-top-30"},ze={class:"tabs-box"},$e=["onClick"],Ee=ne({__name:"familyParty",setup(Ge){const C=ie("filterDate"),g=s({});se(()=>C,()=>{g.value={...g.value,...ae(C.value)},O()},{deep:!0});const w=s(""),A=s(""),B=s([]),z=k([{label:"当前记录所选时间",value:"今日"},{label:"所选街道",value:"全部"},{label:"记录总数",value:"500"}]),$=k([{label:"红",value:"A"},{label:"灰榜",value:"B"},{label:"黑榜",value:"C"}]),E=k([{label:"就餐场次",value:"A"},{label:"就餐桌数",value:"B"},{label:"就餐人数",value:"C"}]),o=s({}),I=s(),G=s(),y=s(),S=s(),T=s(),N=s(),D=s(),F=s(),Q=[{title:"序号",dataIndex:"id",key:"id"},{title:"就餐信息",dataIndex:"partyInfo",key:"id"},{title:"食堂",dataIndex:"familyBanquetName",key:"id"},{title:"厨师信息",dataIndex:"cookName",key:"id"},{title:"就餐时间",dataIndex:"conductTime",key:"id"}],V=[{title:"排名",dataIndex:"index",key:"id"},{title:"厨师姓名",dataIndex:"cookName",key:"id"},{title:"得分",dataIndex:"score",key:"id"}];le(()=>{O(),Y(),X(),K()});const K=async()=>{const a=await m.getCookLog();F.value=a.map((t,l)=>({...t,index:l+1}))},X=async()=>{const a=await m.getRegisterLog();D.value=a},O=async()=>{const a=await m.getFamilyBanquetOverviews(g.value);o.value=a,j(I.value.chart,Object.keys(a.areaAggregator).map(t=>{var l;return{name:(l=B.value.find(v=>v.id==t))==null?void 0:l.name,value:a.areaAggregator[t]}})),j(y.value.chart,[{name:"A",value:a.kitchenAggregator.A},{name:"B",value:a.kitchenAggregator.B},{name:"C",value:a.kitchenAggregator.C},{name:"未评级",value:a.kitchenAggregator.D}]),y.value.chart.setOption({...S.value.chart.getOption(),xAxis:[{type:"category",boundaryGap:!1,data:a.everyMonthrend[0].map(t=>t+"月")}],series:[{name:"家宴场次",type:"line",areaStyle:{},data:a.everyMonthrend[1]},{name:"家宴桌数",type:"line",areaStyle:{},data:a.everyMonthrend[2]},{name:"聚餐人数",type:"line",areaStyle:{},data:a.everyMonthrend[3]}]}),T.value=Object.values(a.healthyAggregator).reduceRight((t,l)=>t+=l,0),N.value=Object.values(a.kitchenAggregator).reduceRight((t,l)=>t+=l,0)},Y=async()=>{const a=await m.getAreas();B.value=a},H=h({convertData:()=>[{value:18,name:"周一"},{value:20,name:"周二"},{value:30,name:"周三"},{value:28,name:"周四"},{value:10,name:"周五"}],convertlegend:()=>({right:0,left:null,top:"center"}),convertSeries:()=>({width:180,height:200,left:10})}),J=h({convertData:()=>[{value:100,name:"正常"},{value:20,name:"过期"},{value:20,name:"临期"}],convertlegend:()=>({bottom:0,left:"center",top:null,orient:"horizontal"}),convertSeries:()=>({width:180,height:180,left:10})}),U=h({convertData:()=>[{value:100,name:"A"},{value:20,name:"B"},{value:20,name:"C"},{value:20,name:"未评级"}],convertlegend:()=>({bottom:0,left:"center",top:null,orient:"horizontal"}),convertSeries:()=>({width:180,height:180,left:10})}),W=h({convertlegend:()=>({show:!1}),convertYxis:()=>[{type:"value"}],convertXAxis:()=>[{type:"category",boundaryGap:!1,data:["1月","3月","6月","9月","12月"]}],convertSeries:()=>({name:"合格数",type:"line",areaStyle:{},data:[120,132,101,134,90,230,210]})}),Z=a=>{w.value=a.value},ee=a=>{A.value=a.value};return(a,t)=>{const l=R("ContentCard"),v=R("QfTable");return u(),d("div",ue,[e("div",ve,[n(f,{title:"总体概况"}),e("div",me,[n(L,{icon:c(ce),num:o.value.familyBanquetNum,label:"食堂",unit:"次"},null,8,["icon","num"]),n(L,{icon:c(de),num:o.value.sunshineNum,label:"时间",unit:"位"},null,8,["icon","num"])]),e("div",he,[e("div",_e,[e("div",null,[e("div",ge,[t[0]||(t[0]=e("div",{class:"num-label"},"就餐场次",-1)),e("div",ye,r(o.value.mealNum),1)]),n(x,{width:"30%",color:"#83BAFA"})]),e("div",null,[e("div",be,[t[1]||(t[1]=e("div",{class:"num-label"},"就餐桌数",-1)),e("div",fe,r(o.value.tableNum),1)]),n(x,{width:"10%",color:"#F6E89D"})]),e("div",null,[e("div",pe,[t[2]||(t[2]=e("div",{class:"num-label"},"就餐人数",-1)),e("div",xe,r(o.value.dinnerNum),1)]),n(x,{width:"80%",color:"#0FFFFF"})])]),e("div",ke,[n(_,{options:c(H),ref_key:"chart1",ref:I},null,8,["options"]),t[3]||(t[3]=e("div",{class:"chart-msg-1"},"街道分布",-1))])]),e("div",Ce,[t[4]||(t[4]=e("div",{class:"line-title-box"},[e("div",null,"就餐人数保持率"),e("div",{class:"line-num"},"80%")],-1)),e("div",we,[e("div",{class:"inner",style:oe({width:`${o.value.businessPercentage*100}%`})},null,4)])]),e("div",Ae,[n(p,{title:"健康状态"}),n(p,{title:"放心厨房"})]),e("div",Be,[e("div",Ie,[n(_,{options:c(J),ref_key:"chart2",ref:G},null,8,["options"]),e("div",Se,[e("div",Te,r(T.value),1),t[5]||(t[5]=e("div",{class:"chart-content-label"},"总数量",-1))])]),e("div",Ne,[n(_,{options:c(U),ref_key:"chart3",ref:y},null,8,["options"]),e("div",De,[e("div",Fe,r(N.value),1),t[6]||(t[6]=e("div",{class:"chart-content-label"},"总数量",-1))])])]),e("div",null,[n(p,{title:"每月趋势"}),e("div",Oe,[e("div",je,[t[7]||(t[7]=e("div",null,"当前数量",-1)),e("div",Le,[(u(!0),d(M,null,P(E,(i,b)=>(u(),d("div",{class:q({"chart-tab-active":A.value===i.value}),key:b,onClick:te=>ee(i)},r(i.label),11,Me))),128))])]),n(_,{ref_key:"chart4",ref:S,options:c(W)},null,8,["options"])])])]),e("div",Pe,[n(f,{title:"备案登记"}),e("div",Re,[n(l,{contents:z},null,8,["contents"])]),n(v,{data:D.value,columns:Q,color:"blue"},null,8,["data"]),e("div",qe,[n(f,{title:"厨师红黑榜"}),e("div",ze,[(u(!0),d(M,null,P($,(i,b)=>(u(),d("div",{class:q({active:w.value===i.value}),onClick:te=>Z(i),key:b},r(i.label),11,$e))),128))]),n(v,{data:F.value,columns:V,color:"red"},null,8,["data"])])])])}}});const Xe=re(Ee,[["__scopeId","data-v-e099ac1f"]]);export{Xe as default};
